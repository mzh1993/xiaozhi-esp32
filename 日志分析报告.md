# æ—¥å¿—åˆ†ææŠ¥å‘Š

## æ—¥å¿—æ—¶é—´èŒƒå›´ï¼š921-1029è¡Œ

## ä¸€ã€æ•´ä½“æµç¨‹åˆ†æ

### æ­£å¸¸æµç¨‹ âœ…

**å”¤é†’è¯è§¦å‘æµç¨‹**ï¼š
```
I (183562) Application: Wake word detected: ä½ å¥½å°æ™º
I (183872) Application: SetListeningMode called with mode: 0
I (183882) Application: STATE: listening
I (183992) Application: Touch timeout cancelled by tts start  â† æ³¨æ„ï¼šè¿™æ˜¯å”¤é†’è¯ï¼Œä¸æ˜¯è§¦æ‘¸
I (184002) Application: Audio output enabled for tts start
I (184012) Application: STATE: speaking
I (184652) Application: << ä½ å¥½å‘€ï¼
I (184952) Application: First packet delay: lu ms  â† âš ï¸ æ ¼å¼é—®é¢˜
```

**æµç¨‹è¯„ä¼°**ï¼šâœ… **åŸºæœ¬æ­£å¸¸**
- å”¤é†’è¯æ£€æµ‹æ­£å¸¸
- çŠ¶æ€åˆ‡æ¢æ­£å¸¸ï¼ˆlistening â†’ speakingï¼‰
- éŸ³é¢‘è¾“å‡ºå¯ç”¨æ­£å¸¸
- é¦–åŒ…åˆ°è¾¾æ­£å¸¸ï¼ˆçº¦470mså»¶è¿Ÿï¼‰

## äºŒã€å‘ç°çš„é—®é¢˜

### ğŸ”´ é—®é¢˜1ï¼šé¦–åŒ…å»¶è¿Ÿæ—¥å¿—æ ¼å¼ä»ç„¶å¼‚å¸¸

**æ—¥å¿—**ï¼š
```
I (184952) Application: First packet delay: lu ms
```

**åˆ†æ**ï¼š
- ä»£ç å·²ä¿®å¤ä¸ºä½¿ç”¨ `PRIu64` å®
- ä½†è®¾å¤‡ä¸Šè¿è¡Œçš„å¯èƒ½è¿˜æ˜¯æ—§ç‰ˆæœ¬ä»£ç 
- **éœ€è¦é‡æ–°ç¼–è¯‘å¹¶çƒ§å½•**æ‰èƒ½çœ‹åˆ°ä¿®å¤æ•ˆæœ

**é¢„æœŸä¿®å¤å**ï¼š
```
I (184952) Application: First packet delay: 470 ms
```

### ğŸŸ¡ é—®é¢˜2ï¼šæ—¥å¿—ä¿¡æ¯å¯èƒ½è¯¯å¯¼

**æ—¥å¿—**ï¼š
```
I (183992) Application: Touch timeout cancelled by tts start
```

**åˆ†æ**ï¼š
- è¿™æ˜¯**å”¤é†’è¯è§¦å‘**çš„åœºæ™¯ï¼Œä¸æ˜¯è§¦æ‘¸äº‹ä»¶
- ä»£ç ä¸­ `tts start` å¤„ç†ä¼šæ— æ¡ä»¶å–æ¶ˆè§¦æ‘¸è¶…æ—¶å®šæ—¶å™¨
- é€»è¾‘æ˜¯æ­£ç¡®çš„ï¼ˆé˜²æ­¢è¯¯è§¦å‘ï¼‰ï¼Œä½†æ—¥å¿—ä¿¡æ¯å¯èƒ½è¯¯å¯¼

**å»ºè®®ä¼˜åŒ–**ï¼š
- åªåœ¨ç¡®å®æœ‰è§¦æ‘¸è¶…æ—¶å®šæ—¶å™¨è¿è¡Œæ—¶æ‰æ‰“å°æ­¤æ—¥å¿—
- æˆ–è€…åŒºåˆ†å”¤é†’è¯å’Œè§¦æ‘¸äº‹ä»¶çš„æ—¥å¿—

### ğŸŸ¢ é—®é¢˜3ï¼šè®¾å¤‡æ–­å¼€è¿æ¥ï¼ˆéä»£ç é—®é¢˜ï¼‰

**æ—¥å¿—**ï¼š
```
--- Error: device reports readiness to read but returned no data (device disconnected or multiple access on port?)
--- Waiting for the device to reconnect.
```

**åˆ†æ**ï¼š
- è¿™æ˜¯ä¸²å£ç›‘æ§å·¥å…·çš„é—®é¢˜ï¼Œä¸æ˜¯ä»£ç é—®é¢˜
- è®¾å¤‡å¯èƒ½çŸ­æš‚æ–­å¼€æˆ–ä¸²å£è¢«å…¶ä»–ç¨‹åºå ç”¨
- ç³»ç»Ÿè‡ªåŠ¨é‡è¿ï¼Œä¸å½±å“åŠŸèƒ½

### âœ… æ­£å¸¸è¡Œä¸º

**1. éŸ³é¢‘è¾“å‡ºè‡ªåŠ¨å…³é—­ï¼ˆçœç”µï¼‰**ï¼š
```
I (23702) AudioCodec: Set output enable to false
I (206702) AudioCodec: Set output enable to false
```
âœ… **æ­£å¸¸**ï¼šç©ºé—²æ—¶è‡ªåŠ¨å…³é—­è¾“å‡ºï¼Œç¬¦åˆçœç”µç­–ç•¥

**2. æƒ…ç»ªè§¦å‘æ­£å¸¸**ï¼š
```
I (184402) TC118S_EAR_CONTROLLER: ShouldTriggerEmotion: checking happy
I (184422) TC118S_EAR_CONTROLLER: ShouldTriggerEmotion: happy is allowed to trigger
I (184442) TC118S_EAR_CONTROLLER: Started sequence with 4 steps
```
âœ… **æ­£å¸¸**ï¼šæƒ…ç»ªè§¦å‘å’Œåºåˆ—æ‰§è¡Œæ­£å¸¸

**3. é¦–åŒ…å»¶è¿Ÿæ—¶é—´**ï¼š
- ä» `tts start` (çº¦184002ms) åˆ°é¦–åŒ…åˆ°è¾¾ (184952ms)
- å®é™…å»¶è¿Ÿçº¦ **950ms**ï¼ˆä½†æ—¥å¿—æ˜¾ç¤º"lu"ï¼‰
- âœ… **å»¶è¿Ÿæ—¶é—´æ­£å¸¸**ï¼ˆ<2ç§’ç›®æ ‡ï¼‰

## ä¸‰ã€å…³é”®æŒ‡æ ‡è¯„ä¼°

| æŒ‡æ ‡ | ç›®æ ‡ | å®é™… | çŠ¶æ€ |
|------|------|------|------|
| å”¤é†’è¯â†’speakingåˆ‡æ¢ | â‰¤2ç§’ | ~400ms | âœ… ä¼˜ç§€ |
| é¦–åŒ…å»¶è¿Ÿ | â‰¤2ç§’ | ~950msï¼ˆä¼°ç®—ï¼‰ | âœ… æ­£å¸¸ |
| éŸ³é¢‘è¾“å‡ºä¿æŠ¤ | speakingæœŸé—´ä¸å…³é—­ | æ­£å¸¸ | âœ… æ­£å¸¸ |
| çŠ¶æ€åˆ‡æ¢ | æµç•…æ— å¡é¡¿ | æ­£å¸¸ | âœ… æ­£å¸¸ |

## å››ã€éœ€è¦æ”¹è¿›çš„åœ°æ–¹

### 1. ğŸ”´ **é¦–åŒ…å»¶è¿Ÿæ—¥å¿—æ ¼å¼**ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
- **çŠ¶æ€**ï¼šä»£ç å·²ä¿®å¤ï¼Œä½†è®¾å¤‡ä¸Šå¯èƒ½è¿˜æ˜¯æ—§ç‰ˆæœ¬
- **å»ºè®®**ï¼šé‡æ–°ç¼–è¯‘å¹¶çƒ§å½•æœ€æ–°ä»£ç 

### 2. ğŸŸ¡ **æ—¥å¿—ä¿¡æ¯ä¼˜åŒ–**ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰
- **é—®é¢˜**ï¼šå”¤é†’è¯åœºæ™¯ä¸‹ä¹Ÿæ˜¾ç¤º"Touch timeout cancelled"
- **å»ºè®®**ï¼šå¢åŠ æ¡ä»¶åˆ¤æ–­ï¼Œåªåœ¨ç¡®å®æœ‰è§¦æ‘¸è¶…æ—¶æ—¶æ‰æ‰“å°

### 3. ğŸŸ¢ **å…¶ä»–æ—¥å¿—æ ¼å¼**ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
- **é—®é¢˜**ï¼š`TC118S_EAR_CONTROLLER` ä¸­ä»æœ‰ `time: lu` çš„æ—¥å¿—
- **ä½ç½®**ï¼š`main/ear/tc118s_ear_controller.cc:994`
- **å»ºè®®**ï¼šç»Ÿä¸€ä½¿ç”¨ `PRIu64` æ ¼å¼åŒ–

## äº”ã€æ€»ä½“è¯„ä¼°

### âœ… **ç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼šæ­£å¸¸**

**ä¼˜ç‚¹**ï¼š
1. âœ… å”¤é†’è¯æ£€æµ‹å’Œå“åº”æ­£å¸¸
2. âœ… çŠ¶æ€åˆ‡æ¢æµç•…ï¼Œæ— å¡é¡¿
3. âœ… éŸ³é¢‘è¾“å‡ºä¿æŠ¤æœºåˆ¶æ­£å¸¸
4. âœ… é¦–åŒ…å»¶è¿Ÿåœ¨å¯æ¥å—èŒƒå›´å†…ï¼ˆ~950msï¼‰
5. âœ… è€³æœµåŠ¨ä½œä¸éŸ³é¢‘æ’­æ”¾å¹¶è¡Œæ‰§è¡Œ

**éœ€è¦æ”¹è¿›**ï¼š
1. âš ï¸ é¦–åŒ…å»¶è¿Ÿæ—¥å¿—æ ¼å¼ï¼ˆéœ€é‡æ–°çƒ§å½•ï¼‰
2. âš ï¸ æ—¥å¿—ä¿¡æ¯å¯ä»¥æ›´ç²¾ç¡®ï¼ˆåŒºåˆ†å”¤é†’è¯å’Œè§¦æ‘¸ï¼‰

**ç»“è®º**ï¼š
- **æ ¸å¿ƒåŠŸèƒ½æ­£å¸¸**ï¼Œä¼˜åŒ–æ•ˆæœåŸºæœ¬è¾¾æˆ
- **æ—¥å¿—æ ¼å¼é—®é¢˜**éœ€è¦é‡æ–°çƒ§å½•æœ€æ–°ä»£ç æ‰èƒ½çœ‹åˆ°ä¿®å¤æ•ˆæœ
- **ç³»ç»Ÿç¨³å®šæ€§è‰¯å¥½**ï¼Œæ— æ˜æ˜¾å¼‚å¸¸

---

**å»ºè®®ä¸‹ä¸€æ­¥**ï¼š
1. é‡æ–°ç¼–è¯‘å¹¶çƒ§å½•æœ€æ–°ä»£ç ï¼ŒéªŒè¯é¦–åŒ…å»¶è¿Ÿæ—¥å¿—æ ¼å¼ä¿®å¤
2. ä¼˜åŒ–æ—¥å¿—ä¿¡æ¯ï¼ŒåŒºåˆ†å”¤é†’è¯å’Œè§¦æ‘¸äº‹ä»¶åœºæ™¯
3. ç»§ç»­ç›‘æ§ç³»ç»Ÿè¿è¡Œï¼Œæ”¶é›†æ›´å¤šæ•°æ®éªŒè¯ä¼˜åŒ–æ•ˆæœ

